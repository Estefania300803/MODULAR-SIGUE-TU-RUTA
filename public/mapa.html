<!DOCTYPE html>
<html lang="es">

<head>
    <!-- Codificación y configuración responsive -->
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Título de la pestaña -->
    <title>Mapa</title>

    <!-- Favicon -->
    <link rel="website icon" type="svg" href="assets/iconos/Logo_s-l.svg">

    <!-- CSS propio para el mapa -->
    <link rel="stylesheet" href="assets/css/pages/mapa.css">
    <!-- CSS de layout general (sidebar + contenido) -->
    <link rel="stylesheet" href="assets/css/pages/page_laterales.css">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Iconos de Bootstrap (bi-...) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Bootstrap JS (bundle + Popper) para modales, collapse, etc. -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Leaflet CDN: CSS y JS para el mapa -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
</head>

<body>
    <!-- Contenedor general: sidebar + contenido principal -->
    <div class="wrapper">
        <!-- ===================================================== -->
        <!-- SIDEBAR LATERAL                                       -->
        <!-- ===================================================== -->
        <nav class="sidebar" id="aside">
            <ul>
                <!-- Encabezado del menú lateral -->
                <li class="menu-item">
                    <i class="bi bi-list"></i>
                    <span>Menú</span>
                </li>

                <!-- Opción: Principal (lleva a home_page_singin.html) -->
                <li class="menu-item" onclick="window.location.href = './home_page_singin.html'">
                    <i class="bi bi-grid" onclick="window.location.href = './home_page_singin.html'"></i>
                    <span>Principal</span>
                </li>

                <!-- Opción: Mapas (página actual, ícono destacado) -->
                <li class="menu-item">
                    <i class="bi bi-map" style="color: black; -webkit-text-stroke: 0.6px black; transform: scale(1.1);"
                        onclick="window.location.href = './mapa.html'"></i>
                    <span>Mapas</span>
                </li>

                <!-- Opción: Camiones (lleva a camiones.html) -->
                <li class="menu-item" onclick="window.location.href = './camiones.html'">
                    <i class="bi bi-bus-front" onclick="window.location.href = './camiones.html'"></i>
                    <span>Camiones</span>
                </li>

                <!-- Opción: Nosotros (versión con sesión iniciada) -->
                <li class="menu-item" onclick="window.location.href = './nosotros_singin.html'">
                    <i class="bi bi-book" onclick="window.location.href = './nosotros_sigin.html'"></i>
                    <span>Nosotros</span>
                </li>
            </ul>
        </nav>

        <!-- ===================================================== -->
        <!-- CONTENIDO PRINCIPAL                                   -->
        <!-- ===================================================== -->
        <div class="content">
            <!-- ==================== HEADER SUPERIOR ==================== -->
            <header class="header">
                <!-- Logo + nombre de la app -->
                <div class="logo-container">
                    <img src="assets/iconos/Logo_s-l.svg" alt="Icono" class="logo-icon">
                    <div class="logo">Sigue Tu Ruta</div>
                </div>

                <!-- Acciones del header: buscador + perfil -->
                <div class="header-actions">
                    <!-- Buscador de paradas con sugerencias -->
                    <div class="input-wrapper">
                        <!-- Input del buscador; id usado por mapa_leaflet.js -->
                        <input type="text" placeholder="Buscar parada..." class="search" id="buscador-paradas"
                            autocomplete="on">
                        <!-- Contenedor donde se insertan las sugerencias -->
                        <div id="sugerencias-paradas"></div>
                    </div>

                    <!-- Botón "Cómo llegar" (actualmente comentado)
                    <button class="how-to-btn">
                        <i class="bi bi-arrow-left-right me-2"></i>Cómo Llegar
                    </button>
                    -->

                    <!-- Botón de perfil:
                         - Llama a toggleMenu() (sidebar.js) para abrir el menú de usuario
                         - Muestra la imagen del usuario (actualizable vía JS) -->
                    <button class="profile-btn" type="button" id="btn-user" onclick="toggleMenu()">
                        <img id="imagenPerfil" src="assets/imagenes/perfil.jpg">
                    </button>
                </div>
            </header>

            <!-- ================= MENÚ DE USUARIO DESLIZANTE =============== -->
            <!-- Overlay que oscurece el fondo al abrir el menú de usuario -->
            <div id="menu-overlay" onclick="toggleMenu()"></div>

            <!-- Menú deslizante de usuario (perfil, compartir, cerrar sesión) -->
            <div id="user-menu">
                <!-- Botón para cerrar el menú (X) -->
                <i class="bi bi-x close-menu" onclick="toggleMenu()"></i>

                <!-- Nombre del usuario logueado (relleno por UsuarioLogueado.js) -->
                <p id="userName"></p>

                <!-- Lista de opciones del menú de usuario -->
                <ul>
                    <!-- Ir a perfil -->
                    <li>
                        <i class="bi bi-person"></i>
                        <a href="./perfil.html">Perfil</a>
                    </li>

                    <!-- Botón Compartir: usado por compartir.js (Web Share API) -->
                    <ul id="btn-compartir">
                        <li>
                            <i class="bi bi-share"></i>
                            <a href="#">Compartir</a>
                        </li>
                    </ul>

                    <!-- Cerrar sesión (id usado por UsuarioLogueado.js para logout) -->
                    <li>
                        <i class="bi bi-box-arrow-right"></i>
                        <a href="#" id="logout-btn">Cerrar Sesión</a>
                    </li>
                </ul>
            </div>

            <!-- ====================== SECCIÓN PRINCIPAL ==================== -->
            <section class="main">
                <div class="container">
                    <!-- Botón ☰ para abrir menú lateral móvil (rutas + simbología) -->
                    <button id="open-menu-btn">☰</button>

                    <!-- Menú lateral desde la derecha (simbología y rutas) -->
                    <div id="side-menu" class="side-menu">
                        <!-- Botón X para cerrar el menú lateral -->
                        <span id="close-menu-btn" class="close-btn">&times;</span>

                        <section class="main2">
                            <!-- ===================== MENÚ DE RUTAS ===================== -->
                            <div class="custom-card2">
                                <!-- Botón que despliega/oculta la lista de rutas -->
                                <button class="custom-select-button" id="toggleList">
                                    Rutas
                                </button>

                                <!-- Lista de rutas con iconos de ojo (toggle-ruta) -->
                                <ul class="list-options" id="listContainer">
                                    <!-- data-ruta se usa en dropdown_menu.js / ubicacion_gps.js -->
                                    <li>
                                        Ruta C01
                                        <i class="bi bi-eye-slash toggle-ruta" data-ruta="C01"></i>
                                    </li>
                                    <li>
                                        Ruta C02
                                        <i class="bi bi-eye-slash toggle-ruta" data-ruta="C02"></i>
                                    </li>
                                </ul>
                            </div>

                            <!-- ===================== SIMBOLOGÍA ======================== -->
                            <div class="custom-card">
                                <div class="symbol-title">Simbología</div>

                                <!-- Camiones en circulación (icono bus verde) -->
                                <div class="symbol-item">
                                    <i class="bi bi-bus-front-fill text-success"></i>
                                    <span>Camiones en circulación</span>
                                </div>

                                <!-- Paradas de camiones (marcador azul) -->
                                <div class="symbol-item">
                                    <i class="bi bi-geo-alt-fill text-primary"></i>
                                    <span>Paradas de Camiones</span>
                                </div>

                                <!-- Ubicación del usuario (marcador rojo) -->
                                <div class="symbol-item">
                                    <i class="bi bi-geo-alt-fill text-danger"></i>
                                    <span>Tu ubicación</span>
                                </div>

                                <!-- Tarifa de uso -->
                                <div class="symbol-item">
                                    <i class="bi bi-currency-dollar text-warning"></i>
                                    <span>Tarifa: $9.50</span>
                                </div>
                            </div>
                        </section>
                    </div>

                    <!-- ======================== CONTENEDOR DEL MAPA =================== -->
                    <div class="map-container">
                        <!-- Div donde Leaflet dibuja el mapa (id usado en mapa_leaflet.js) -->
                        <div id="mi_mapa"></div>
                    </div>
                </div>
            </section>
        </div> <!-- /.content -->
    </div> <!-- /.wrapper -->

    <!-- ========================================================= -->
    <!-- SCRIPTS DEL PROYECTO                                      -->
    <!-- ========================================================= -->

    <!-- Lógica principal del mapa (rutas, paradas, buscador, geolocalización) -->
    <script src="./src/components/mapa_leaflet.js" defer></script>

    <!-- Control de sidebar (abrir/cerrar aside + menú usuario) -->
    <script src="./src/components/sidebar.js" defer></script>

    <!-- Menú lateral móvil (botones open/close, toggle de lista de rutas) -->
    <script src="./src/components/siderbar_menu_simbologia.js" defer></script>

    <!-- (Si existe) lógica adicional para dropdown del mapa -->
    <script src="./src/components/dropdown_mapa.js" defer></script>

    <!-- Toggle de iconos ojo y visibilidad de polylines en el mapa -->
    <script src="./src/js/dropdown_menu.js" defer></script>

    <!-- Manejo de usuario logueado (nombre, foto, logout, etc.) -->
    <script src="./src/views/UsuarioLogueado.js" defer type="module"></script>

    <!-- Seguimiento GPS en tiempo real de camiones (Firebase + Leaflet) -->
    <script src="./src/components/ubicacion_gps.js" type="module" defer></script>

    <!-- Lógica de compartir (Web Share API) -->
    <script src="./src/components/compartir.js" defer type="module"></script>
</body>

</html>